function[J, V, loop, AllParam,Data2] = GN_mode4(ImageCoordinates,WorldCoordinates,InitialAllParam)  
% 假设我们有 n 个站位，每个站位包含 m 个特征点
% n = 3;
% m = 10;

% 代入已知每个站位的图像坐标和世界坐标
Image_Coordinates = ImageCoordinates;   % cell(1,n) 每个cell里（m，2）
World_Coordinates = WorldCoordinates;         % cell(1,n) 每个cell里（m，3）
[~,n] = size(ImageCoordinates);

% 代入已知相机初始内参数畸变参数和初始外参数
AllParam = InitialAllParam;   %[x0, y0, k1, k2, k3, k4, k5, p1, p2, b1, b2 , phiz1,phix1,phiy1,Tx1,Ty1,Tz1,phiz2,phix2......]  
                              %！！！phiz，phix，phiy 必须为弧度值！！！
%% 构建雅克比矩阵
rowJ = 0;
% 寻找雅克比矩阵的总行数
for i = 1:n
    
    [tem,~] = size(Image_Coordinates{1,i});
    rowJ = tem + rowJ;
    
end
J_row = 2 * rowJ; J_col = 11 + 6 * n;
% J = zeros(J_row, J_col); % 雅克比矩阵的大小
V = zeros(J_row, 1);     % 残差矩阵

%% 迭代循环
loop = 0;       % 迭代次数
loopMax = 200;  % 最多迭代次数
change = 20; 
lastm_all = 0;  % 记录当前特征点之前点的总数
alpha = 1;
while loop < loopMax && change > 2*10^-11 %判断左右均成立往下执行
    loop = loop + 1;
    
        % 获取当前新的内参数
        x0 = AllParam(1);
        y0 = AllParam(2);
        k1 = AllParam(3);
        k2 = AllParam(4);
        k3 = AllParam(5);
        k4 = AllParam(6);
        k5 = AllParam(7);
        p1 = AllParam(8);
        p2 = AllParam(9);
        b1 = AllParam(10);
        b2 = AllParam(11);
        lastm_all = 0;
        J = zeros(J_row, J_col); % 雅克比矩阵的大小
        V = zeros(J_row, 1);     % 残差矩阵
        % 遍历每个站位
    for i = 1:n
        % 获取当前站位的图像坐标和世界坐标
        image_coords = Image_Coordinates{1,i};
        world_coords = World_Coordinates{1,i};
       
        % 获取当前站位的外参
        phiz = AllParam(6*(i-1)+12); phix = AllParam(6*(i-1)+13); phiy = AllParam(6*(i-1)+14);
        Tx = AllParam(6*(i-1)+15); Ty = AllParam(6*(i-1)+16); Tz = AllParam(6*(i-1)+17);
        R = R_generate_rad(phiz,phix,phiy);
        % 获取每张图的点数
        [m,~] = size(image_coords);
        % 遍历每个特征点
        for j = 1:m
            % 获取当前特征点的图像坐标和世界坐标
            x = image_coords(j, 1);
            y = image_coords(j, 2);
            X_w = world_coords(j, 1);
            Y_w = world_coords(j, 2);
            Z_w = world_coords(j, 3);
            % 获取当前相机坐标
            X_c = R(1, :)*([X_w; Y_w; Z_w]-[Tx; Ty; Tz]);
            Y_c = R(2, :)*([X_w; Y_w; Z_w]-[Tx; Ty; Tz]);
            Z_c = R(3, :)*([X_w; Y_w; Z_w]-[Tx; Ty; Tz]);
            % 获取畸变方程
            x_int = x - x0;
            y_int = y - y0;
            r = x_int^2 + y_int^2;
            x_distortion = p1*(2*x_int^2+r)+2*p2*x_int*y_int+b1*x_int+b2*y_int;  
            y_distortion = p2*(2*y_int^2+r)+2*p1*x_int*y_int; 
            %计算入射角
            theta = atan(sqrt(X_c^2 + Y_c^2)/Z_c);
            rtheta = k1*theta + k2*theta^3 + k3*theta^5 + k4*theta^7 + k5*theta^9;
            %鱼眼共线方程
            fx = x0 - x_distortion -rtheta*(X_c/(sqrt(X_c^2 + Y_c^2)));
            fy = y0 - y_distortion -rtheta*(Y_c/(sqrt(X_c^2 + Y_c^2)));
            % 计算当前特征点的残差
            V(2*lastm_all + j*2-1,:) = x-fx;
            V(2*lastm_all + j*2,:)   = y-fy;
            % 计算雅克比矩阵
            jx1 = b1 + 2*p2*(y - y0) + p1*(6*x - 6*x0) + 1;
            jx2 = b2 + 2*p2*(x - x0) + p1*(2*y - 2*y0);
            jx3 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx4 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx5 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx6 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx7 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx8 = - 3*(x - x0)^2 - (y - y0)^2;
            jx9 = -2*(x - x0)*(y - y0);
            jx10 = x0 - x;
            jx11 = y0 - y;
            jx12 = -(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx13 = ((2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2)) - ((cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*((k1*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx14 = (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*((k1*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) + (((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) + ((2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2));
            jx15 = (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*((k1*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - ((cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - ((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2));
            jx16 = ((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2)) - (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*((k1*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (cos(phix)*sin(phiz)*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jx17 = ((cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*((k1*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) + ((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2));
            
            
            jy1 = 2*p1*(y - y0) + p2*(2*x - 2*x0);
            jy2 = 2*p1*(x - x0) + p2*(6*y - 6*y0) + 1;
            jy3 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy4 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy5 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy6 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy7 = -(atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy8 = -2*(x - x0)*(y - y0);
            jy9 = - (x - x0)^2 - 3*(y - y0)^2;
            jy10 = 0;
            jy11 = 0;
            jy12 = (((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy13 = ((2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2)) - ((cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*((k1*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*(((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*(Ty - Y_w) + cos(phiy)*sin(phix)*(Tz - Z_w) + sin(phix)*sin(phiy)*(Tx - X_w)))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + (2*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*cos(phiz)*(Tz - Z_w) - cos(phiz)*sin(phix)*(Ty - Y_w) + cos(phix)*cos(phiz)*sin(phiy)*(Tx - X_w)) + 2*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))*(cos(phix)*cos(phiy)*sin(phiz)*(Tz - Z_w) - sin(phix)*sin(phiz)*(Ty - Y_w) + cos(phix)*sin(phiy)*sin(phiz)*(Tx - X_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy14 = (((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*((k1*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*(((cos(phix)*cos(phiy)*(Tx - X_w) - cos(phix)*sin(phiy)*(Tz - Z_w))*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 - (2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) + ((2*((Tx - X_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) + (Tz - Z_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*((Tx - X_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + (Tz - Z_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2));
            jy15 = ((cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) + (((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*((k1*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (cos(phix)*sin(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - ((2*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2));
            jy16 = ((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2)) - (((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*((k1*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*cos(phix)*cos(phiz)*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) + 2*cos(phix)*sin(phiz)*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) + (sin(phix)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - (cos(phix)*cos(phiz)*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            jy17 = ((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(3/2)) - (((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))*((k1*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (3*k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^2*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (5*k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^4*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (7*k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^6*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1) + (9*k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^8*((2*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w)) - 2*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz))*((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w)))/(2*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)*(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))) - (cos(phix)*cos(phiy)*(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2))/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2))/((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w))^2 + 1)))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2) - ((sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix))*(k5*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^9 + k4*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^7 + k3*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^5 + k2*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))^3 + k1*atan((((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2)/(cos(phix)*cos(phiy)*(Tz - Z_w) - sin(phix)*(Ty - Y_w) + cos(phix)*sin(phiy)*(Tx - X_w)))))/(((Tz - Z_w)*(sin(phiy)*sin(phiz) + cos(phiy)*cos(phiz)*sin(phix)) - (Tx - X_w)*(cos(phiy)*sin(phiz) - cos(phiz)*sin(phix)*sin(phiy)) + cos(phix)*cos(phiz)*(Ty - Y_w))^2 + ((Tx - X_w)*(cos(phiy)*cos(phiz) + sin(phix)*sin(phiy)*sin(phiz)) - (Tz - Z_w)*(cos(phiz)*sin(phiy) - cos(phiy)*sin(phix)*sin(phiz)) + cos(phix)*sin(phiz)*(Ty - Y_w))^2)^(1/2);
            
            
            % fx对内外参求导写入J
            J(2*lastm_all + j*2-1,1:11) = [jx1 jx2 jx3 jx4 jx5 jx6 jx7 jx8 jx9 jx10 jx11];
            J(2*lastm_all + j*2-1,(12+6*(i-1)):(12+6*(i-1)+5)) = [jx12 jx13 jx14 jx15 jx16 jx17];
            % fy对内外参求导写入J
            J(2*lastm_all + j*2,1:11) = [jy1 jy2 jy3 jy4 jy5 jy6 jy7 jy8 jy9 jy10 jy11];
            J(2*lastm_all + j*2,12+6*(i-1):12+6*(i-1)+5) = [jy12 jy13 jy14 jy15 jy16 jy17];
        
%                         if rank(J'*J) == 10      %验证代入多少点时秩为多少
%                             KKKKK = size(J);
%                         end
            
        end
        lastm_all = lastm_all + m;
        
        
    end
    
    for i = 1:J_col
        A(1,i)=norm(J(:,i));    %求每列二范数
    end
    A=repmat(A,J_row,1);            %平铺生成点除要用的二范数矩阵
    Jguiyi=J./A;                %A./B表示A矩阵与B矩阵对应元素相除，所以要求A，B行数列数相等%相当于J右乘A（对角矩阵）的逆
    Aduijiao = diag(A(1,:),0);  %生成二范数矩阵的对角阵,用于Delta还原的公式推导
    A=[];
    Delta_E = inv(Jguiyi'* Jguiyi)*Jguiyi'* V;
    Delta_L= inv(Aduijiao)*Delta_E;
    AllParam = AllParam + alpha*Delta_L';
    change = norm(Delta_L');
    
    %% 数据统计
    Data4(loop) = change;
    Data3{loop} = AllParam;
    Data2{loop} = Delta_L;
    Data1{loop} = V;

end
% % 计算参数的更新步长 delta_x
% delta_x = -J \ V;
% 
% % 更新相机内参数和外参数
% delta_K = delta_x(1:3);
% delta_R = delta_x(4:6);
% delta_t = delta_x(7:end);
% 
% InParam = InParam + delta_K';
% R = expm(skew_symmetric(delta_R')) * R;
% T = T + delta_t;


end